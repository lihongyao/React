# å‰è¨€

[React Router](https://reactrouter.com/) æ˜¯ React ç”Ÿæ€ä¸­æœ€æµè¡Œçš„è·¯ç”±åº“ä¹‹ä¸€ï¼Œå®ƒè®©ä½ èƒ½å¤Ÿåœ¨å•é¡µåº”ç”¨ï¼ˆSPAï¼‰ä¸­åˆ›å»ºå¤šé¡µé¢ä½“éªŒï¼Œè€Œæ— éœ€åˆ·æ–°é¡µé¢ã€‚

> *React Router æ˜¯ä¸€æ¬¾ä»¥ç”¨æˆ·ä¸ºä¸­å¿ƒã€ç¬¦åˆ Web æ ‡å‡†ã€å¯éƒ¨ç½²åœ¨ä»»ä½•ç¯å¢ƒçš„å¤šç­–ç•¥è·¯ç”±å™¨ã€‚ä½ æ—¢å¯ä»¥å°†å…¶ä½œä¸º React æ¡†æ¶çš„ä¸€éƒ¨åˆ†ï¼Œä¹Ÿå¯ä»¥å°†å…¶ä½œä¸ºç‹¬ç«‹åº“ï¼Œä¸è‡ªå·±çš„æ¶æ„ç»“åˆä½¿ç”¨ã€‚â€”â€”æ‘˜è‡ªå®˜ç½‘*

åœ¨ React Router v7 ä¸­ï¼Œè·¯ç”±ç®¡ç†å˜å¾—æ›´åŠ ç›´è§‚ï¼Œæ”¯æŒæ›´ç®€æ´çš„ API è®¾è®¡ï¼Œå¹¶ä¼˜åŒ–äº†æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†æ·±å…¥æ¢ç´¢ v7 ç‰ˆæœ¬çš„æ–°ç‰¹æ€§åŠå…¶æœ€ä½³å®è·µã€‚

# å‡†å¤‡

åœ¨å¼€å§‹ä½¿ç”¨ React Router v7 ä¹‹å‰ï¼Œè¯·ç¡®ä¿ä½ çš„å¼€å‘ç¯å¢ƒæ»¡è¶³ä»¥ä¸‹æœ€ä½è¦æ±‚ï¼š

- Node.js 20+
- React 18+
- ReactDOM 18+

## åˆ›å»ºé¡¹ç›®

ä¸ºäº†æ›´å¥½åœ°æ¼”ç¤º React Router v7ï¼Œæˆ‘ä»¬ä½¿ç”¨ [Vite](https://vitejs.dev/) æ„å»ºä¸€ä¸ª React + TypeScript é¡¹ç›®ï¼š

```shell
$ pnpm create vite react-router-examples --template react-ts && code react-router-examples  
$ pnpm install && pnpm add react-router
```

> æç¤ºï¼šreact-router-examples æ˜¯é¡¹ç›®åç§°ï¼Œä½ å¯ä»¥æ ¹æ®éœ€è¦ä¿®æ”¹ã€‚

## é…ç½® Tailwind CSS

ä¸ºäº†é¿å…æ‰‹å†™ CSSï¼Œæˆ‘ä»¬ä½¿ç”¨ Tailwind CSS è¿›è¡Œæ ·å¼ç®¡ç†ï¼š

```shell
$ pnpm add tailwindcss @tailwindcss/vite
```

é…ç½® Vite æ’ä»¶ï¼šåœ¨ vite.config.ts é…ç½®æ–‡ä»¶ä¸­æ·»åŠ  @tailwindcss/vite æ’ä»¶

```js
import { defineConfig } from 'vite'
import tailwindcss from '@tailwindcss/vite'
export default defineConfig({
  plugins: [
    ...
    tailwindcss(),
  ],
})
```

å¯¼å…¥ Tailwind CSSï¼šåœ¨æ‚¨çš„ CSS æ–‡ä»¶ï¼ˆ*é€šå¸¸æ˜¯ index.css*ï¼‰ä¸­å¯¼å…¥ Tailwind CSS çš„å†…å®¹

```css
@import "tailwindcss";
```

## åˆ›å»º App.tsx

ä¿®æ”¹ App.tsxï¼Œç¡®ä¿ Tailwind CSS ç”Ÿæ•ˆï¼š

```tsx
export default function App() {
  return (
    <div className="m-4">
      <h1 className="text-blue-500">Hello, react-router!</h1>
    </div>
  );
}
```

## é…ç½® React Router

åœ¨ main.tsx ä¸­ä½¿ç”¨ BrowserRouter ä½œä¸ºåº”ç”¨çš„æ ¹ç»„ä»¶ï¼š

```tsx
import { StrictMode } from "react";
import { createRoot } from "react-dom/client";
import { BrowserRouter } from "react-router";
import App from "@/App.tsx";
import "@/index.css";

createRoot(document.getElementById("root")!).render(
  <StrictMode>
    <BrowserRouter>
      <App />
    </BrowserRouter>
  </StrictMode>
);
```

## è¿è¡Œé¡¹ç›®

æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼š

```shell
$ pnpm dev
```

æ‰“å¼€æµè§ˆå™¨ï¼Œé¡µé¢æ˜¾ç¤º **è“è‰² â€œHello, React Router!â€ æ–‡æœ¬**ï¼Œå³è¡¨ç¤ºç¯å¢ƒé…ç½®æˆåŠŸï¼ ğŸ‰

# è·¯ç”±

@See https://reactrouter.com/start/library/routing

## é…ç½®è·¯ç”±

@See https://reactrouter.com/start/library/routing#configuring-routes

åœ¨ React Router v7 ä¸­ï¼Œè·¯ç”±æ˜¯é€šè¿‡æ¸²æŸ“ \<Routes> å’Œ \<Route> ç»„ä»¶æ¥é…ç½®çš„ï¼Œå®ƒä»¬çš„ä½œç”¨æ˜¯ **å°† URL ç‰‡æ®µï¼ˆè·¯å¾„ï¼‰ä¸ UI ç»„ä»¶è¿›è¡Œå…³è”**ã€‚

ç®€å•æ¥è¯´ï¼Œå°±æ˜¯ï¼š

- \<Routes> ç»„ä»¶ç”¨äºåŒ…è£¹æ‰€æœ‰çš„è·¯ç”±è§„åˆ™ã€‚

- \<Route> ç»„ä»¶ç”¨äºå®šä¹‰ç‰¹å®šçš„è·¯å¾„åº”è¯¥æ¸²æŸ“å“ªä¸ª UI ç»„ä»¶ã€‚

**ç¤ºä¾‹ï¼š**

```tsx
import { Route, Routes } from "react-router";

const Home = () => <h1>This is Home page.</h1>;
const About = () => <h1>This is About page.</h1>;

export default function App() {
  return (
    <Routes>
      <Route path="/" element={<Home />} />
      <Route path="/about" element={<About />} />
    </Routes>
  );
}

```

ğŸ”¹ å½“ç”¨æˆ·è®¿é—® / æ—¶ï¼Œä¼šæ¸²æŸ“ Home ç»„ä»¶ã€‚

ğŸ”¹ å½“ç”¨æˆ·è®¿é—® /about æ—¶ï¼Œä¼šæ¸²æŸ“ About ç»„ä»¶ã€‚

è¿™æ ·å°±å®ç°äº† **URL ä¸ UI çš„å¯¹åº”å…³ç³»**ï¼Œè®© React åº”ç”¨å…·å¤‡äº†å‰ç«¯è·¯ç”±åŠŸèƒ½ï¼ ğŸš€

ä¸‹é¢æ˜¯ä¸€ä¸ªå®Œå–„çš„ç¤ºä¾‹é…ç½®ï¼ˆä»…ä¾›å‚è€ƒï¼‰ï¼š

```tsx
<Routes>
  <Route index element={<Home />} />
  <Route path="about" element={<About />} />

  <Route element={<AuthLayout />}>
    <Route path="login" element={<Login />} />
    <Route path="register" element={<Register />} />
  </Route>

  <Route path="concerts">
    <Route index element={<ConcertsHome />} />
    <Route path=":city" element={<City />} />
    <Route path="trending" element={<Trending />} />
  </Route>
</Routes>;
```

1. **æ ¹è·¯ç”±é…ç½®**
   - `<Route index element={<Home />} />`ï¼šå½“è·¯å¾„æ˜¯æ ¹è·¯å¾„ `/` æ—¶ï¼Œæ¸²æŸ“ `Home` ç»„ä»¶ã€‚

2. **æ™®é€šå­è·¯ç”±**
   - `<Route path="about" element={<About />} />`ï¼šå½“è·¯å¾„æ˜¯ `/about` æ—¶ï¼Œæ¸²æŸ“ `About` ç»„ä»¶ã€‚

3. **åµŒå¥—è·¯ç”±ï¼ˆå¸ƒå±€ç»„ä»¶ï¼‰**
   - `<Route element={<AuthLayout />}>`ï¼šè¡¨ç¤ºç™»å½•å’Œæ³¨å†Œé¡µé¢éƒ½ä½¿ç”¨ `AuthLayout` ä½œä¸ºå¸ƒå±€ç»„ä»¶ã€‚
     - `/login`ï¼šæ¸²æŸ“ `Login` ç»„ä»¶ã€‚
     - `/register`ï¼šæ¸²æŸ“ `Register` ç»„ä»¶ã€‚

4. **åµŒå¥—åŠ¨æ€è·¯ç”±**
   - `<Route path="concerts">`ï¼šè¡¨ç¤ºæ‰€æœ‰ä»¥ `/concerts` å¼€å¤´çš„è·¯å¾„ä¼šä½¿ç”¨è¿™éƒ¨åˆ†é…ç½®ã€‚
     - `/concerts`ï¼šæ¸²æŸ“ `ConcertsHome` ç»„ä»¶ã€‚
     - `/concerts/:city`ï¼šåŠ¨æ€è·¯ç”±ï¼Œ`:city` æ˜¯åŠ¨æ€å‚æ•°ï¼Œä¾‹å¦‚ `/concerts/chengdu` ä¼šæ¸²æŸ“ `City` ç»„ä»¶ã€‚
     - `/concerts/trending`ï¼šæ¸²æŸ“ `Trending` ç»„ä»¶ã€‚

## åµŒå¥—è·¯ç”±

@See https://reactrouter.com/start/library/routing#nested-routes

åµŒå¥—è·¯ç”±å…è®¸å­è·¯ç”±ç»§æ‰¿çˆ¶è·¯ç”±çš„è·¯å¾„ï¼Œå¹¶åœ¨çˆ¶è·¯ç”±çš„ UI å†…éƒ¨æ¸²æŸ“å­è·¯ç”±çš„å†…å®¹ã€‚

ç¤ºä¾‹ä»£ç ï¼š

```tsx
<Routes>
  <Route path="dashboard" element={<Dashboard />}>
    <Route index element={<Home />} />
    <Route path="settings" element={<Settings />} />
  </Route>
</Routes>
```

çˆ¶çº§çš„è·¯å¾„ä¼šè‡ªåŠ¨åŒ…å«åœ¨å­çº§ä¸­ï¼Œå› æ­¤æ­¤é…ç½®ä¼šåˆ›å»º `/dashboard` å’Œ `/dashboard/settings` URLã€‚

å­è·¯ç”±é€šè¿‡çˆ¶è·¯ç”±ä¸­çš„ \<Outlet/> è¿›è¡Œæ¸²æŸ“

```tsx
import { Outlet } from "react-router";

export default function Dashboard() {
  return (
    <div>
      <h1>Dashboard</h1>
      {/* will either be <Home/> or <Settings/> */}
      <Outlet />
    </div>
  );
}
```

## å¸ƒå±€è·¯çº¿

@See https://reactrouter.com/start/library/routing#layout-routes

**æ²¡æœ‰è·¯å¾„çš„è·¯ç”± (**\<Route> **ä¸å¸¦** path**)** å¯ä»¥ä¸ºå­è·¯ç”±åˆ›å»ºåµŒå¥—ç»“æ„ï¼Œä½†ä¸ä¼šå‘ URL æ·»åŠ æ–°çš„è·¯å¾„æ®µã€‚

ç®€å•ç†è§£ï¼š

- è¿™ç§è·¯ç”±é€šå¸¸ç”¨äºä¸ºä¸€ç»„å­è·¯ç”±æä¾›å…¬å…±çš„å¸ƒå±€æˆ–é€»è¾‘ã€‚
- å®ƒåªè´Ÿè´£åµŒå¥—å’Œç»„ç»‡ï¼Œä¸ç›´æ¥å½±å“ URL çš„ç»“æ„ã€‚

**ç¤ºä¾‹**ï¼š

```tsx
<Routes>
  <Route element={<AuthLayout />}>
    <Route path="login" element={<Login />} />
    <Route path="register" element={<Register />} />
  </Route>
</Routes>
```

**è§£æ**ï¼š

1. `<Route element={<AuthLayout />}>`ï¼šè¿™æ˜¯ä¸€ä¸ªæ²¡æœ‰ path çš„è·¯ç”±ï¼Œä½œç”¨æ˜¯ä¸ºå…¶å­è·¯ç”±æä¾›å…¬å…±çš„ `AuthLayout` å¸ƒå±€ã€‚
2. å­è·¯ç”±ï¼š
   - `/login`ï¼šæ¸²æŸ“ AuthLayout å†…éƒ¨çš„ Login ç»„ä»¶ã€‚
   - `/register`ï¼šæ¸²æŸ“ AuthLayout å†…éƒ¨çš„ Register ç»„ä»¶ã€‚

åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œè™½ç„¶ AuthLayout ç»„ä»¶å‚ä¸æ¸²æŸ“ï¼Œä½†å®ƒå¹¶æ²¡æœ‰åœ¨ URL ä¸­å¢åŠ è·¯å¾„æ®µã€‚

**ç‰¹ç‚¹**ï¼š

1.	ç»„ç»‡ç»“æ„ï¼šè¿™ç§ç”¨æ³•ä¸»è¦ç”¨äºç»„ç»‡ä»£ç ç»“æ„ï¼Œè€Œéæ§åˆ¶ URLã€‚
2.	å¸¸è§åœºæ™¯ï¼š
   - å…¬å…±å¸ƒå±€ï¼šä¸ºä¸€ç»„é¡µé¢ï¼ˆå¦‚ç™»å½•ã€æ³¨å†Œï¼‰æä¾›ç»Ÿä¸€çš„å¸ƒå±€ã€‚
   - é€»è¾‘å¤ç”¨ï¼šåœ¨çˆ¶è·¯ç”±ä¸­å®šä¹‰å…±äº«é€»è¾‘ï¼ˆå¦‚æƒé™éªŒè¯ï¼‰ï¼Œå¯¹å­è·¯ç”±ç”Ÿæ•ˆã€‚

**æ€»ç»“**ï¼šæ²¡æœ‰è·¯å¾„çš„è·¯ç”±è®©ä½ å¯ä»¥çµæ´»ç®¡ç†å¸ƒå±€å’Œé€»è¾‘ï¼Œè€Œä¸éœ€è¦åœ¨ URL ä¸Šæ˜¾ç¤ºå¤šä½™çš„è·¯å¾„éƒ¨åˆ†ã€‚è¿™æ ·æ—¢ä¿æŒäº† URL ç®€æ´ï¼Œåˆè®©ä»£ç ç»“æ„æ›´æ¸…æ™°ã€‚

## è·¯ç”±ç´¢å¼•

@See https://reactrouter.com/start/library/routing#index-routes

**Index è·¯ç”±** æ˜¯ä¸€ç§ç‰¹æ®Šçš„å­è·¯ç”±ï¼Œå®ƒä¼šåœ¨çˆ¶è·¯ç”±çš„ \<Outlet /> ä¸­æ¸²æŸ“ï¼Œä¸”è·¯å¾„ä¸çˆ¶è·¯ç”±å®Œå…¨ç›¸åŒã€‚å¯ä»¥å°†å®ƒç†è§£ä¸ºâ€œçˆ¶è·¯ç”±çš„é»˜è®¤å­è·¯ç”±â€ã€‚é…ç½®æ—¶éœ€è¦ä½¿ç”¨ index å±æ€§ã€‚

```tsx
<Routes>
  <Route path="/" element={<Root />}>
    {/* renders into the outlet in <Root> at "/" */}
    <Route index element={<Home />} />

    <Route path="dashboard" element={<Dashboard />}>
      {/* renders into the outlet in <Dashboard> at "/dashboard" */}
      <Route index element={<DashboardHome />} />
      <Route path="settings" element={<Settings />} />
    </Route>
  </Route>
</Routes>
```

**ç‰¹ç‚¹**ï¼š

1. Index è·¯ç”±ä¸ä¼šå¢åŠ è·¯å¾„æ®µï¼Œå®ƒä¸çˆ¶è·¯ç”±å…±äº«ç›¸åŒçš„ URLã€‚
2. å½“ç”¨æˆ·è®¿é—®çˆ¶è·¯ç”±ä¸”æ²¡æœ‰åŒ¹é…åˆ°å…¶ä»–å­è·¯ç”±æ—¶ï¼ŒIndex è·¯ç”±çš„å†…å®¹ä¼šä½œä¸ºé»˜è®¤æ¸²æŸ“ã€‚
3. ä½¿ç”¨åœºæ™¯ï¼š
   - æä¾›çˆ¶è·¯ç”±çš„é»˜è®¤è§†å›¾ã€‚
   - è®¾ç½®ä¸€ä¸ªé¦–é¡µæˆ–é»˜è®¤é¡µé¢

> æ³¨æ„ï¼š
>
> 1. Index è·¯ç”±å¿…é¡»ä¾é™„äºçˆ¶è·¯ç”±ï¼Œä¸”çˆ¶è·¯ç”±éœ€è¦åœ¨å…¶å¸ƒå±€ç»„ä»¶ä¸­åŒ…å« \<Outlet />ï¼Œä»¥ä¾¿æ¸²æŸ“ Index è·¯ç”±æˆ–å…¶ä»–å­è·¯ç”±ã€‚
> 2. ç´¢å¼•è·¯ç”±ä¸èƒ½æœ‰å­è·¯ç”±ã€‚å¦‚æœä½ æœŸæœ›è¿™ç§è¡Œä¸ºï¼Œå¯èƒ½éœ€è¦ä¸€ä¸ªå¸ƒå±€è·¯çº¿ã€‚

## è·¯ç”±å‰ç¼€

@See https://reactrouter.com/start/library/routing#route-prefixes

**æ²¡æœ‰** element **å±æ€§çš„** \<Route path> ä¼šä¸ºå…¶å­è·¯ç”±æ·»åŠ è·¯å¾„å‰ç¼€ï¼Œä½†ä¸ä¼šå¼•å…¥çˆ¶çº§å¸ƒå±€ç»„ä»¶ã€‚è¿™ç§é…ç½®å¸¸ç”¨äºç»„ç»‡è·¯å¾„ç»“æ„ï¼Œè€Œæ— éœ€æ¸²æŸ“é¢å¤–çš„ UIã€‚

```tsx
<Routes>
  <Route path="concerts">
    <Route index element={<ConcertsHome />} />
    <Route path=":city" element={<City />} />
    <Route path="trending" element={<Trending />} />
  </Route>
</Routes>
```

**è§£æ**ï¼š

1. **çˆ¶è·¯ç”±**ï¼š
   - `<Route path="concerts">` å®šä¹‰äº†ä¸€ä¸ªè·¯å¾„å‰ç¼€ concertsï¼Œä½†æ²¡æœ‰ elementï¼Œæ‰€ä»¥ä¸ä¼šæ¸²æŸ“ä»»ä½•çˆ¶çº§å¸ƒå±€ã€‚
2. **å­è·¯ç”±**ï¼š
   - `index`ï¼šè·¯å¾„ä¸º /concertsï¼Œæ¸²æŸ“ ConcertsHome ç»„ä»¶ã€‚
   - `:city`ï¼šè·¯å¾„ä¸º /concerts/:cityï¼Œæ”¯æŒåŠ¨æ€å‚æ•°ï¼Œå¦‚ /concerts/newyork æ¸²æŸ“ City ç»„ä»¶ã€‚
   - `trending`ï¼šè·¯å¾„ä¸º /concerts/trendingï¼Œæ¸²æŸ“ Trending ç»„ä»¶ã€‚

**ç‰¹ç‚¹**ï¼š

1. **è·¯å¾„ç®¡ç†**ï¼šçˆ¶è·¯ç”±ä»…ç”¨ä½œç»„ç»‡è·¯å¾„ç»“æ„ï¼Œå…¶å­è·¯ç”±è·¯å¾„ä¼šè‡ªåŠ¨ç»§æ‰¿çˆ¶è·¯ç”±çš„è·¯å¾„å‰ç¼€ã€‚ä¾‹å¦‚ï¼Œconcerts æ˜¯æ‰€æœ‰å­è·¯ç”±çš„åŸºç¡€è·¯å¾„ã€‚
2. **æ²¡æœ‰çˆ¶çº§ UI**ï¼šå› ä¸ºçˆ¶è·¯ç”±æ²¡æœ‰ elementï¼Œæ‰€ä»¥ä¸ä¼šæœ‰å¤šä½™çš„çˆ¶çº§å¸ƒå±€æ¸²æŸ“ã€‚ä»…å­è·¯ç”±ä¼šåœ¨å¯¹åº”è·¯å¾„ä¸‹æ¸²æŸ“ã€‚
3. **é€‚ç”¨åœºæ™¯**ï¼šå½“ä½ åªéœ€è¦è·¯å¾„å±‚çº§åˆ’åˆ†ï¼Œè€Œä¸éœ€è¦çˆ¶å¸ƒå±€ç»„ä»¶æ—¶ï¼Œæ¯”å¦‚åœ¨ä¸€ä¸ªæ¨¡å—ä¸‹å®šä¹‰å¤šä¸ªé¡µé¢ã€‚

## åŠ¨æ€è·¯ç”±

@See https://reactrouter.com/start/library/routing#dynamic-segments

**åŠ¨æ€è·¯å¾„æ®µ**ï¼ˆDynamic Segmentï¼‰æ˜¯æŒ‡è·¯å¾„ä¸­çš„æŸä¸ªéƒ¨åˆ†ä»¥ : å¼€å¤´ã€‚è¿™ç§è·¯å¾„æ®µä¼šåœ¨åŒ¹é…åˆ°å¯¹åº” URL æ—¶ï¼Œå°†è¯¥éƒ¨åˆ†è§£æä¸ºåŠ¨æ€å‚æ•°ï¼Œå¹¶é€šè¿‡ useParams ç­‰è·¯ç”± API æä¾›ç»™ç»„ä»¶ä½¿ç”¨ã€‚

```tsx
<Routes>
  <Route path="users">
    <Route path=":userId" element={<UserProfile />} />
  </Route>
</Routes>
```

```tsx
import { useParams } from "react-router";

export default function UserProfile() {
  const params = useParams<{ userId: string }>();
  return (
    <div>
      <h1>UserProfile</h1>
      <p>User ID: {params.userId}</p>
    </div>
  );
}
```

å¯ä»¥åœ¨ä¸€æ¡è·¯ç”±è·¯å¾„ä¸­æ‹¥æœ‰å¤šä¸ªåŠ¨æ€æ®µï¼Œæ¯”å¦‚ /users/:userId/orders/:orderIdï¼Œå¯ä»¥é€šè¿‡ useParams è·å–æ‰€æœ‰å‚æ•°ã€‚

## å¯é€‰è·¯ç”±

@See https://reactrouter.com/start/library/routing#optional-segments

å¯ä»¥é€šè¿‡åœ¨è·¯å¾„æ®µçš„æœ«å°¾æ·»åŠ  ? æ¥ä½¿è·¯å¾„æ®µå˜ä¸º**å¯é€‰**ã€‚è¿™æ„å‘³ç€è¯¥è·¯å¾„æ®µå¯ä»¥å‡ºç°åœ¨ URL ä¸­ï¼Œä¹Ÿå¯ä»¥ä¸å‡ºç°ï¼Œå¹¶ä¸”ä¸¤ç§æƒ…å†µéƒ½ä¼šåŒ¹é…å¯¹åº”çš„è·¯ç”±ã€‚

æ­¤å¤–ï¼Œé™æ€è·¯å¾„æ®µä¹Ÿå¯ä»¥æ˜¯å¯é€‰çš„ã€‚

```tsx
<Routes>
  <Route path="products/:productId?" element={<ProductDetails />} />
  <Route path="about/company?" element={<CompanyDetails />} />
</Routes>
```

## 404

```tsx
<Route path="*" element={<NotFound />} />
```

## é“¾æ¥

@See https://reactrouter.com/start/library/routing#linking

ä½¿ç”¨ Link å’Œ NavLink ä» UI é“¾æ¥åˆ°è·¯çº¿ï¼š

```tsx
import { Link, NavLink } from "react-router";

export default function Header() {
  return (
    <nav>
      {/* NavLink makes it easy to show active states */}
      <NavLink to="/" className={({ isActive }) => (isActive ? "active" : "")}>
        Home
      </NavLink>
      <Link to="/concerts/salt-lake-city">Concerts</Link>
    </nav>
  );
}
```

# å¯¼èˆª

@See https://reactrouter.com/start/library/navigating

åœ¨ React Router ä¸­ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡ä»¥ä¸‹ä¸‰ç§æ–¹å¼å®ç°åº”ç”¨ç¨‹åºçš„å¯¼èˆªã€‚

## \<Link>

\<Link> æä¾›äº†å£°æ˜å¼å¯¼èˆªï¼Œç”¨äºåˆ›å»ºé“¾æ¥ï¼Œå®ç°é¡µé¢é—´çš„è·³è½¬ã€‚

ç‰¹ç‚¹ï¼š

1. å£°æ˜å¼ï¼šé€šè¿‡ to å±æ€§æŒ‡å®šç›®æ ‡è·¯å¾„ã€‚
2. ä¸åˆ·æ–°é¡µé¢ï¼šåªæ›´æ–°åœ°å€æ å’Œæ¸²æŸ“å¯¹åº”çš„è·¯ç”±ç»„ä»¶ã€‚

ç¤ºä¾‹ï¼š

```tsx
import { Link } from "react-router";

export default function Header() {
  return (
    <nav>
      <Link to="/">Home</Link>
      <Link to="/dashboard">Dashboard</Link>
    </nav>
  );
}
```

åœºæ™¯ï¼šé€‚ç”¨äºåˆ›å»ºç®€å•çš„å¯¼èˆªé“¾æ¥ï¼Œå¦‚èœå•æˆ–æŒ‰é’®ã€‚

## \<NavLink>

\<NavLink> æ˜¯ \<Link> çš„å¢å¼ºç‰ˆæœ¬ï¼Œé™¤äº†å¯¼èˆªåŠŸèƒ½å¤–ï¼Œè¿˜ä¼šæ ¹æ®å½“å‰è·¯ç”±çŠ¶æ€è‡ªåŠ¨æ·»åŠ æ ·å¼ã€‚

ç‰¹ç‚¹ï¼š

1. è‡ªåŠ¨æ·»åŠ  active ç±»ï¼šå½“é“¾æ¥åŒ¹é…å½“å‰è·¯å¾„æ—¶ï¼Œè‡ªåŠ¨åº”ç”¨ active æ ·å¼ã€‚
2. åŠ¨æ€æ ·å¼æ”¯æŒï¼šå¯ä»¥é€šè¿‡ className æˆ– style å±æ€§è‡ªå®šä¹‰æ´»åŠ¨çŠ¶æ€çš„æ ·å¼ã€‚

ç¤ºä¾‹ï¼š

```tsx
import { NavLink } from "react-router";

export default function Header() {
  return (
    <nav className="space-x-4">
      <NavLink to="/">Home</NavLink>
      <NavLink to="/dashboard">Dashboard</NavLink>
    </nav>
  );
}
```

å®ƒè¿˜åœ¨ classNameã€style å’Œå…·æœ‰æ´»åŠ¨çŠ¶æ€çš„å­çº§ä¸Šæä¾›å›è°ƒå±æ€§ï¼Œç”¨äºå†…è”æ ·å¼æˆ–æ¡ä»¶æ¸²æŸ“ï¼š

```tsx
{/* className */}
<NavLink 
  to="/dashboard" 
  className={({ isActive }) => 
    (isActive ? "text-blue-500" : " text-gray-500")
  }
>
  Dashboard
</NavLink>

{/* style */}
<NavLink 
  to="/dashboard" 
  style={({ isActive }) => ({
    color: isActive ? 'blue' : 'black'
  })}
>
  Dashboard
</NavLink>

{/* children */}
<NavLink to="/dashboard">
  {({ isActive }) => (
    <span className={isActive ? 'active' : ''}>
      {isActive ? 'Active' : 'Inactive'}
    </span>
  )}  
</NavLink>
```

åœºæ™¯ï¼šé€‚ç”¨äºå¯¼èˆªæ æˆ–èœå•ï¼Œéœ€è¦é«˜äº®å½“å‰æ´»åŠ¨é¡µé¢çš„åœºæ™¯ã€‚

## useNavigate

useNavigate æ˜¯ä¸€ä¸ª Hookï¼Œç”¨äºåœ¨ä»£ç é€»è¾‘ä¸­ä»¥ç¼–ç¨‹æ–¹å¼å®ç°å¯¼èˆªã€‚

ç‰¹ç‚¹ï¼š

1. ç¼–ç¨‹å¼å¯¼èˆªï¼šæ ¹æ®ä¸šåŠ¡é€»è¾‘åŠ¨æ€è·³è½¬é¡µé¢ã€‚
2. æ”¯æŒå†å²æ ˆæ“ä½œï¼šå¯ä»¥å‰è¿›æˆ–åé€€ã€‚

ç¤ºä¾‹ï¼š

```tsx
import { useNavigate } from "react-router";

function Login() {
  const navigate = useNavigate();
  const handleLogin = () => {
    // -- å‡è®¾ç™»å½•é€»è¾‘éªŒè¯é€šè¿‡
    navigate("/dashboard"); // è·³è½¬åˆ°ä»ªè¡¨ç›˜é¡µé¢
  };
  return <button onClick={handleLogin}>ç™»å½•</button>;
}
```

å†å²æ ˆæ“ä½œï¼š

```tsx
navigate(-1); // å›åˆ°ä¸Šä¸€é¡µ
navigate(1);  // å‰å¾€ä¸‹ä¸€é¡µ
```

åœºæ™¯ï¼šé€‚ç”¨äºæŒ‰é’®ç‚¹å‡»ã€è¡¨å•æäº¤æˆ–éœ€è¦åŸºäºæ¡ä»¶åŠ¨æ€å¯¼èˆªçš„åœºæ™¯ã€‚

## ä¸‰è€…å¯¹æ¯”

| **åŠŸèƒ½**         | `<Link>` | `<NavLink>`  | `useNavigate`            |
| ---------------- | -------- | ------------ | ------------------------ |
| **åŸºæœ¬å¯¼èˆª**     | âœ…        | âœ…            | âœ…                        |
| **å£°æ˜å¼å¯¼èˆª**   | âœ…        | âœ…            | âŒ                        |
| **åŠ¨æ€å¯¼èˆª**     | âŒ        | âŒ            | âœ…                        |
| **è‡ªåŠ¨é«˜äº®**     | âŒ        | âœ…            | âŒ                        |
| **åŠ¨æ€æ ·å¼æ”¯æŒ** | âŒ        | âœ…            | âŒ                        |
| **é€‚ç”¨åœºæ™¯**     | ç®€å•å¯¼èˆª | å¯¼èˆªæ ã€èœå• | æŒ‰é’®ç‚¹å‡»ã€é€»è¾‘æ§åˆ¶çš„è·³è½¬ |

# å‚æ•°

@See https://reactrouter.com/start/library/url-values

## Route Params

è·¯ç”±å‚æ•°ï¼ˆRoute paramsï¼‰æ˜¯ä»åŠ¨æ€è·¯ç”±ç‰‡æ®µä¸­è§£æå‡ºæ¥çš„å€¼ï¼Œç”¨äºåœ¨ç»„ä»¶ä¸­è·å– URL ä¸­çš„åŠ¨æ€éƒ¨åˆ†ã€‚é€šè¿‡åŠ¨æ€ç‰‡æ®µï¼ˆä»¥ `:` å¼€å¤´ï¼‰å®šä¹‰è·¯ç”±æ—¶ï¼ŒReact Router ä¼šæ ¹æ®åŒ¹é…çš„ URL è§£æå‡ºç›¸åº”çš„å‚æ•°å€¼ã€‚

### **åŠ¨æ€ç‰‡æ®µçš„å®šä¹‰**

åŠ¨æ€ç‰‡æ®µé€šè¿‡ : å¼€å¤´å®šä¹‰åœ¨è·¯ç”±è·¯å¾„ä¸­ã€‚ä¾‹å¦‚ï¼š

```tsx
<Routes>
  <Route path="users/:id" element={<UserProfile />} />
</Routes>
```

`:id` æ˜¯ä¸€ä¸ªåŠ¨æ€ç‰‡æ®µï¼Œè¡¨ç¤ºå¯ä»¥åŒ¹é…ä»»æ„çš„ç”¨æˆ· IDã€‚

### **è®¿é—®è·¯ç”±å‚æ•°**

åœ¨ç»„ä»¶ä¸­ï¼Œå¯ä»¥é€šè¿‡ React Router æä¾›çš„ useParams Hook è®¿é—®è¿™äº›åŠ¨æ€å‚æ•°ã€‚

ç¤ºä¾‹ä»£ç ï¼š

```tsx
import { useParams } from 'react-router;

function UserProfile() {
  const { id } = useParams(); // è§£æå‡ºè·¯ç”±ä¸­çš„ id å‚æ•°
  return <h1>ç”¨æˆ· IDï¼š{id}</h1>;
}
```

å½“ URL ä¸º /users/123 æ—¶ï¼š

- è·¯ç”±ä¼šåŒ¹é… users/:id
- useParams è¿”å› { id: '123' }

### **æ”¯æŒå¤šå‚æ•°**

å¯ä»¥åœ¨è·¯å¾„ä¸­å®šä¹‰å¤šä¸ªåŠ¨æ€ç‰‡æ®µï¼š

```tsx
<Routes>
  <Route path="products/:category/:productId" element={<ProductDetails />} />
</Routes>
```

### **ç»„ä»¶ä¸­è®¿é—®å¤šä¸ªå‚æ•°**

```tsx
function ProductDetails() {
  const { category, productId } = useParams();
  return (
    <div>
      <h1>ç±»åˆ«ï¼š{category}</h1>
      <h1>å•†å“ IDï¼š{productId}</h1>
    </div>
  );
}
```

å½“ URL ä¸º /products/electronics/567 æ—¶ï¼š

- useParams è¿”å› { category: 'electronics', productId: '567' }

## URL Search Params

æŸ¥è¯¢å‚æ•°ï¼ˆSearch paramsï¼‰æ˜¯ URL ä¸­ ? ä¹‹åçš„é”®å€¼å¯¹ï¼Œç”¨äºåœ¨é¡µé¢å¯¼èˆªä¸­ä¼ é€’é¢å¤–çš„ä¿¡æ¯ã€‚React Router æä¾›äº† useSearchParams Hookï¼Œç”¨äºæ–¹ä¾¿åœ°è¯»å–å’Œæ“ä½œè¿™äº›æŸ¥è¯¢å‚æ•°ã€‚

### **æŸ¥è¯¢å‚æ•°çš„å®šä¹‰**

æŸ¥è¯¢å‚æ•°æ˜¯ URL ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œä¾‹å¦‚ï¼š

```js
/search?query=react&sort=asc
```

å…¶ä¸­ï¼šquery=react å’Œ sort=asc æ˜¯æŸ¥è¯¢å‚æ•°ã€‚

### **è®¿é—®æŸ¥è¯¢å‚æ•°**

åœ¨ç»„ä»¶ä¸­ä½¿ç”¨ useSearchParams Hookï¼Œå¯ä»¥è½»æ¾è·å–æŸ¥è¯¢å‚æ•°ã€‚

```tsx
import { useSearchParams } from "react-router";
function SearchPage() {
  const [searchParams] = useSearchParams();

  const query = searchParams.get("query");
  const sort = searchParams.get("sort");

  return (
    <div>
      <h1>æœç´¢å…³é”®å­—ï¼š{query}</h1>
      <h1>æ’åºæ–¹å¼ï¼š{sort}</h1>
    </div>
  );
}
```

å½“ URL ä¸º /search?query=react&sort=asc æ—¶ï¼š

- searchParams.get('query') è¿”å› reactã€‚
- searchParams.get('sort') è¿”å› ascã€‚

### **åŠ¨æ€è®¾ç½®æŸ¥è¯¢å‚æ•°**

useSearchParams è¿”å›ä¸€ä¸ªåŒ…å« setSearchParams çš„å‡½æ•°ï¼Œç”¨äºæ›´æ–°æŸ¥è¯¢å‚æ•°ã€‚

ä»£ç ç¤ºä¾‹ï¼š

```tsx
import { useSearchParams } from "react-router";
import { ChangeEvent } from "react";

function SearchPage() {
  const [searchParams, setSearchParams] = useSearchParams();

  const query = searchParams.get("query") || '';

  const handleChange = (e: ChangeEvent<HTMLInputElement>) => {
    // -- æ›´æ–°æŸ¥è¯¢å‚æ•°
    setSearchParams({ query: e.target.value }); 
  };

  return (
    <div>
      <input 
        type="text" value={query} 
        onChange={handleChange} 
        placeholder="æœç´¢å…³é”®å­—" 
      />
    </div>
  );
}
```

å½“ç”¨æˆ·åœ¨è¾“å…¥æ¡†ä¸­è¾“å…¥å†…å®¹æ—¶ï¼ŒURL çš„æŸ¥è¯¢å‚æ•°ä¼šåŠ¨æ€æ›´æ–°ã€‚

### **æ”¯æŒå¤šå‚æ•°æ“ä½œ**

setSearchParams ä¹Ÿå¯ä»¥è®¾ç½®å¤šä¸ªæŸ¥è¯¢å‚æ•°ï¼š

```tsx
setSearchParams({ query: 'react', sort: 'desc' });
```

URL å°†æ›´æ–°ä¸º /search?query=react&sort=descã€‚

### **å®ä¾‹ç±»å‹**

useSearchParams è¿”å›çš„æŸ¥è¯¢å‚æ•°æ˜¯ä¸€ä¸ª URLSearchParams çš„å®ä¾‹ï¼Œæ”¯æŒä»¥ä¸‹å¸¸ç”¨æ–¹æ³•ï¼š

- get(name)ï¼šè·å–æŸä¸ªå‚æ•°çš„å€¼ã€‚
- has(name)ï¼šæ£€æŸ¥æŸä¸ªå‚æ•°æ˜¯å¦å­˜åœ¨ã€‚
- append(name, value)ï¼šæ·»åŠ ä¸€ä¸ªæ–°çš„å‚æ•°ã€‚
- delete(name)ï¼šåˆ é™¤æŸä¸ªå‚æ•°ã€‚
- set(name, value)ï¼šè®¾ç½®æŸä¸ªå‚æ•°çš„å€¼ã€‚

## Location Object

React Router æä¾›äº†ä¸€ä¸ªè‡ªå®šä¹‰çš„ location å¯¹è±¡ï¼ŒåŒ…å«æœ‰å…³å½“å‰ URL çš„ä¸€äº›æœ‰ç”¨ä¿¡æ¯ï¼Œå¯ä»¥é€šè¿‡ useLocation Hook åœ¨ç»„ä»¶ä¸­è®¿é—®ã€‚

### **ä»€ä¹ˆæ˜¯ Location å¯¹è±¡ï¼Ÿ**

location å¯¹è±¡è¡¨ç¤ºå½“å‰é¡µé¢çš„ä½ç½®ä¿¡æ¯ï¼ŒåŒ…å«ä»¥ä¸‹å¸¸è§å±æ€§ï¼š

- pathnameï¼šå½“å‰é¡µé¢çš„è·¯å¾„ï¼ˆä¸åŒ…å«æŸ¥è¯¢å‚æ•°å’Œå“ˆå¸Œéƒ¨åˆ†ï¼‰ã€‚
- searchï¼šæŸ¥è¯¢å‚æ•°éƒ¨åˆ†ï¼ŒåŒ…æ‹¬ ?ã€‚
- hashï¼šURL ä¸­çš„å“ˆå¸Œéƒ¨åˆ†ï¼ŒåŒ…æ‹¬ #ã€‚
- stateï¼šé€šè¿‡å¯¼èˆªä¼ é€’çš„é™„åŠ çŠ¶æ€ã€‚
- keyï¼šæ ‡è¯†è¯¥ä½ç½®çš„å”¯ä¸€é”®ï¼Œé€šå¸¸ç”¨äºè·Ÿè¸ªå¯¼èˆªå†å²ã€‚

### **å¦‚ä½•ä½¿ç”¨ useLocationï¼Ÿ**

é€šè¿‡ useLocation Hook è·å–å½“å‰çš„ location å¯¹è±¡ã€‚

ç¤ºä¾‹ä»£ç ï¼š

```tsx
import { useLocation } from 'react-router;

function LocationInfo() {
  const location = useLocation();
  
  return (
    <div>
      <h1>å½“å‰è·¯å¾„ï¼š{location.pathname}</h1>
      <h2>æŸ¥è¯¢å‚æ•°ï¼š{location.search}</h2>
      <h3>å“ˆå¸Œéƒ¨åˆ†ï¼š{location.hash}</h3>
      <p>çŠ¶æ€ä¿¡æ¯ï¼š{JSON.stringify(location.state)}</p>
      <p>å”¯ä¸€é”®ï¼š{location.key}</p>
    </div>
  );
}
```

å½“ URL ä¸º /location-info?user=123#section1 æ—¶ï¼š

- `location.pathname`ï¼š/profile
- `location.search`ï¼š?user=123
- `location.hash`ï¼š#section1
- `location.state`ï¼šæ˜¾ç¤ºå¯¼èˆªæ—¶ä¼ é€’çš„çŠ¶æ€ï¼ˆå¦‚æœæœ‰ï¼‰ã€‚
- `location.key`ï¼šå¦‚ ac3df4ï¼ˆç”± React Router è‡ªåŠ¨ç”Ÿæˆï¼‰ã€‚

### **é€šè¿‡å¯¼èˆªä¼ é€’çŠ¶æ€**

å¯ä»¥åœ¨å¯¼èˆªæ—¶é€šè¿‡ state ä¼ é€’é¢å¤–çš„ä¿¡æ¯ï¼Œä¾›ç›®æ ‡ç»„ä»¶ä½¿ç”¨ã€‚

**å¯¼èˆªæ—¶è®¾ç½®çŠ¶æ€**

```tsx
import { Link } from 'react-router';

function Home() {
  return (
    <Link 
      to="/profile" 
      state={{ from: 'homepage', userId: 123 }}
    >
      è·³è½¬åˆ°ä¸ªäººèµ„æ–™
    </Link>
  );
}
```

**åœ¨ç›®æ ‡é¡µé¢è¯»å–çŠ¶æ€**

```tsx
import { useLocation } from 'react-router';

function Profile() {
  const location = useLocation();
  const state = location.state;

  return (
    <div>
      <h1>æ¥è‡ªé¡µé¢ï¼š{state?.from}</h1>
      <h2>ç”¨æˆ· IDï¼š{state?.userId}</h2>
    </div>
  );
}
```

å½“ç”¨æˆ·ç‚¹å‡»é“¾æ¥è·³è½¬åˆ° /profile æ—¶ï¼Œstate ä¼šæºå¸¦ { from: 'homepage', userId: 123 }ã€‚

### æ€»ç»“

useLocation æä¾›äº†æœ‰å…³å½“å‰ URL çš„è¯¦ç»†ä¿¡æ¯ï¼Œé€‚åˆä»¥ä¸‹åœºæ™¯ï¼š

1. **åŠ¨æ€æ˜¾ç¤ºé¡µé¢å†…å®¹**ï¼šæ ¹æ®è·¯å¾„æˆ–æŸ¥è¯¢å‚æ•°åŠ¨æ€æ¸²æŸ“å†…å®¹ã€‚

2. **çŠ¶æ€ä¼ é€’**ï¼šåœ¨å¯¼èˆªæ—¶é™„åŠ é¢å¤–æ•°æ®ã€‚

3. **è°ƒè¯•ä¸åˆ†æ**ï¼šæ£€æŸ¥å½“å‰è·¯å¾„ã€æŸ¥è¯¢å‚æ•°å’Œå“ˆå¸Œä¿¡æ¯ã€‚

# æ‰©å±•

## useBlocker

useBlocker æ˜¯ react-router-dom æä¾›çš„ä¸€ä¸ª Hookï¼Œç”¨äº**æ‹¦æˆªå®¢æˆ·ç«¯è·¯ç”±è·³è½¬**ï¼Œå¹¶å…è®¸ä½ **æ§åˆ¶æ˜¯å¦å…è®¸è·³è½¬**ï¼ˆæ¯”å¦‚å¼¹å‡ºç¡®è®¤æ¡†ç­‰ï¼‰ã€‚å®ƒä¸èƒ½æ‹¦æˆª**é¡µé¢åˆ·æ–°**æˆ–**è·¨åŸŸå¯¼èˆª**ï¼Œä½†å¯¹ SPA å†…çš„å¯¼èˆªæœ‰æ•ˆã€‚

# API Reference

@See https://api.reactrouter.com/v7/

